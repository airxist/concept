(this.csbJsonP=this.csbJsonP||[]).push([["codemirror-editor"],{"../../node_modules/worker-loader/dist/cjs.js?publicPath=/&name=monaco-linter.[hash:8].worker.js!./src/app/overmind/effects/vscode/LinterWorker/index.js":function(e,t){e.exports=function(){return new Worker("/monaco-linter.ace8e018.worker.js")}},"./src/app/components/CodeEditor/CodeMirror/index.js":function(e,t,r){"use strict";r.r(t);var o=r("../../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=r.n(o),s=r("../../node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(s),d=r("../../node_modules/lodash-es/debounce.js"),c=(r("../../node_modules/codemirror/addon/dialog/dialog.js"),r("../../node_modules/codemirror/addon/hint/show-hint.js"),r("../../node_modules/codemirror/addon/tern/tern.js"),r("../../node_modules/codemirror/addon/lint/lint.css"),r("../../node_modules/codemirror/addon/lint/lint.js"),r("../common/lib/sandbox/modules.js")),l=r("./src/app/utils/codemirror/index.js"),a=r("../../node_modules/codemirror/lib/codemirror.js"),m=r.n(a),u=r("../codesandbox-api/dist/codesandbox.es5.js"),h=r("../../node_modules/react/index.js"),p=r("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),g=r("../../node_modules/worker-loader/dist/cjs.js?publicPath=/&name=monaco-linter.[hash:8].worker.js!./src/app/overmind/effects/vscode/LinterWorker/index.js"),f=r.n(g),v=r("./src/app/components/CodeEditor/FuzzySearch/index.js"),y=r("./src/app/components/CodeEditor/CodeMirror/elements.js");function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const w={};class x extends h.Component{constructor(e){var t;super(e),t=this,i()(this,"codemirror",void 0),i()(this,"codemirrorElement",void 0),i()(this,"server",void 0),i()(this,"sandbox",void 0),i()(this,"currentModule",void 0),i()(this,"settings",void 0),i()(this,"dependencies",void 0),i()(this,"disposeInitializer",void 0),i()(this,"setupCodeSandboxListener",()=>Object(u.listen)(this.handleMessage)),i()(this,"handleMessage",e=>{if("editor.open-module"===e.action)try{const t=Object(c.resolveModule)(e.path,this.sandbox.modules,this.sandbox.directories);this.setCurrentModule(t.id)}catch(e){}}),i()(this,"setErrors",e=>{const t=this.codemirror.getValue().split("\n");t.forEach((e,t)=>{this.codemirror.removeLineClass(t,"background","cm-line-error")}),e.forEach(e=>{0!==e.line&&e.line<=t.length&&this.codemirror.addLineClass(e.line-1,"background","cm-line-error")})}),i()(this,"linterWorker",void 0),i()(this,"validate",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;if(!t.currentModule||!/\.jsx?$/.test(t.currentModule.title))return void r([]);if(""===e.trim())return void r([]);const o=t.linterWorker;o&&(o.postMessage({code:e,title:t.currentModule.title,version:e}),o.onmessage=t=>{const o=t.data,n=o.markers;o.version===e&&r(n.map(e=>({message:"eslint: ".concat(e.message),severity:2===e.severity?"warning":"error",from:new m.a.Pos(e.startLineNumber-1,e.startColumn-1),to:new m.a.Pos(e.endLineNumber-1,e.endColumn-1)})))})})),i()(this,"changeSettings",function(){var e=n()((function*(e){const o={"Cmd-/":e=>{e.listSelections().forEach(()=>{e.toggleComment({lineComment:"//"})})},"Cmd-P":()=>{t.setState({fuzzySearchEnabled:!0},()=>t.forceUpdate())}},n=e=>{t.server&&t.server.updateArgHints(e)},s=r=>{if(t.server){const o=new RegExp("[.a-z_$]","i");r&&r.display&&r.display.input&&r.display.input.textarea&&r.display.input.textarea.value&&r.display.input.textarea.value.slice(-1).match(o)&&r.showHint({hint:t.server.getHint,completeSingle:!1,customKeys:j({Up:(e,t)=>t.moveFocus(-1),Down:(e,t)=>t.moveFocus(1),PageUp:(e,t)=>t.moveFocus(1-t.menuSize(),!0),PageDown:(e,t)=>t.moveFocus(t.menuSize()-1,!0),Home:(e,t)=>t.setFocus(0),End:(e,t)=>t.setFocus(t.length-1),Enter:(e,t)=>t.pick(),Tab:(e,t)=>t.pick()},e.vimMode?{}:{Esc:(e,t)=>t.close()})})}};if(e.autoCompleteEnabled){const e=yield r.e("codemirror-tern").then(r.t.bind(null,"../deps/dist/tern.js",7));window.tern=e.tern,t.server=t.server||new m.a.TernServer({defs:[e.ecmascriptJson]}),t.codemirror.on("cursorActivity",n),t.codemirror.on("inputRead",s),t.codemirror.setOption("extraKeys",j({"Ctrl-Space":e=>{t.server&&t.server.complete(e)},"Ctrl-I":e=>{t.server&&t.server.showType(e)},"Ctrl-O":e=>{t.server&&t.server.showDocs(e)},"Alt-.":e=>{t.server&&t.server.jumpToDef(e)},"Alt-,":e=>{t.server&&t.server.jumpBack(e)},"Ctrl-Q":e=>{t.server&&t.server.rename(e)},"Ctrl-.":e=>{t.server&&t.server.selectName(e)},Tab:e=>{if(e.somethingSelected())e.indentSelection("add");else{const t=Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t,"end","+input");try{e.execCommand("emmetExpandAbbreviation")}catch(e){console.error(e)}}},Enter:"emmetInsertLineBreak"},o))}else t.server=null,t.codemirror.off("cursorActivity",n),t.codemirror.off("inputRead",s);e.vimMode?(yield r.e("vendors~codemirror-vim").then(r.t.bind(null,"../../node_modules/codemirror/keymap/vim.js",7)),t.codemirror.setOption("keyMap","vim")):t.codemirror.setOption("keyMap","sublime"),e.lintEnabled?t.linterWorker||(t.linterWorker=new f.a,t.codemirror.setOption("lint",{getAnnotations:t.validate,async:!0})):t.codemirror.setOption("lint",!1),t.codemirror.setOption("tabSize",t.props.settings.tabWidth),t.forceUpdate()}));return function(t){return e.apply(this,arguments)}}()),i()(this,"changeModule",function(){var e=n()((function*(e){t.currentModule=e;const r=t.currentModule;if(!w[r.id]){const e=(yield t.getMode(r.title))||"typescript";w[r.id]=new m.a.Doc(r.code||"",e)}t.codemirror.swapDoc(w[r.id]),t.changeCode(r.code||""),t.configureEmmet()}));return function(t){return e.apply(this,arguments)}}()),i()(this,"changeCode",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;const o=t.codemirror.getCursor();t.codemirror.setCursor(o),e===t.getCode()||r&&t.currentModule.id!==r||t.codemirror.setValue(e)})),i()(this,"getMode",function(){var e=n()((function*(e){if(null==e)return"jsx";const t=e.match(/\.([^.]*)$/);if(t){if("css"===t[1]||"scss"===t[1]||"less"===t[1])return yield r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue").then(r.t.bind(null,"../../node_modules/codemirror/mode/css/css.js",7)),"less"===t[1]?"text/x-less":"scss"===t[1]?"text/x-scss":"css";if("html"===t[1]||"vue"===t[1])return yield Promise.all([r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue"),r.e("codemirror-html")]).then(r.t.bind(null,"../../node_modules/codemirror/mode/htmlmixed/htmlmixed.js",7)),"vue"===t[1]?(yield Promise.all([r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue").then(r.t.bind(null,"../../node_modules/codemirror/mode/css/css.js",7)),Promise.all([r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue"),r.e("codemirror-sass")]).then(r.t.bind(null,"../../node_modules/codemirror/mode/sass/sass.js",7)),r.e("vendors~codemirror-stylus~codemirror-vue").then(r.t.bind(null,"../../node_modules/codemirror/mode/stylus/stylus.js",7)),r.e("codemirror-handlebars").then(r.t.bind(null,"../../node_modules/codemirror/mode/handlebars/handlebars.js",7)),Promise.all([r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue"),r.e("vendors~codemirror-stylus~codemirror-vue"),r.e("vendors~codemirror-vue")]).then(r.t.bind(null,"../../node_modules/codemirror/mode/vue/vue.js",7))]),{name:"vue"}):"htmlmixed";if("md"===t[1])return yield r.e("vendors~codemirror-markdown").then(r.t.bind(null,"../../node_modules/codemirror/mode/markdown/markdown.js",7)),"markdown";if("json"===t[1])return"application/json";if("sass"===t[1])return yield Promise.all([r.e("vendors~codemirror-css~codemirror-html~codemirror-sass~codemirror-vue"),r.e("codemirror-sass")]).then(r.t.bind(null,"../../node_modules/codemirror/mode/sass/sass.js",7)),"sass";if("styl"===t[1])return yield r.e("vendors~codemirror-stylus~codemirror-vue").then(r.t.bind(null,"../../node_modules/codemirror/mode/stylus/stylus.js",7)),"stylus"}return"jsx"}));return function(t){return e.apply(this,arguments)}}()),i()(this,"initializeCodemirror",n()((function*(){const e=t.codemirrorElement,r=t.currentModule,o=r.code,n=r.id,s=r.title;!t.props.onlyViewMode&&t.props.settings.vimMode&&(m.a.commands.save=t.handleSaveCode);const i=(yield t.getMode(s))||"typescript";var d;w[n]=new m.a.Doc(o||"",i),t.codemirror=Object(l.a)(e,w[n]),t.props.highlightedLines&&(d=t.codemirror,t.props.highlightedLines.forEach(e=>{d.addLineClass(+e-1,"background","cm-line-highlight")})),t.codemirror.on("changes",t.handleChange),t.changeSettings(t.settings)}))),i()(this,"handleChange",(e,t)=>{"setValue"!==t.origin&&this.props.onChange&&this.props.onChange(e.getValue(),this.currentModule.shortid)}),i()(this,"getCode",()=>this.codemirror.getValue()),i()(this,"handleSaveCode",n()((function*(){const e=t.props.onSave;e&&e(t.codemirror.getValue())}))),i()(this,"configureEmmet",n()((function*(){const e=t.currentModule.title,r=(yield t.getMode(e))||"typescript",o="htmlmixed"===r?"html":r,n="jsx"===o?{jsx:!0}:null;t.codemirror.setOption("emmet",{addons:n,syntax:o})}))),i()(this,"closeFuzzySearch",()=>{this.setState({fuzzySearchEnabled:!1},()=>this.forceUpdate())}),i()(this,"setCurrentModule",e=>{this.closeFuzzySearch(),window.__isTouch||this.codemirror.focus(),this.props.onModuleChange&&this.props.onModuleChange(e)}),this.state={fuzzySearchEnabled:!1},this.sandbox=e.sandbox,this.currentModule=e.currentModule,this.settings=e.settings,this.codeSandboxListener=this.setupCodeSandboxListener(),this.resizeEditor=Object(d.a)(this.resizeEditor,30)}shouldComponentUpdate(e){return this.props.width!==e.width||this.props.height!==e.height?(this.resizeEditor(),!0):this.props.theme.vscodeTheme!==e.theme.vscodeTheme}componentWillUnmount(){this.disposeInitializer&&this.disposeInitializer(),this.codeSandboxListener&&this.codeSandboxListener()}componentDidMount(){this.initializeCodemirror().then(()=>{this.changeSettings(this.settings),this.configureEmmet(),this.props.onInitialized&&(this.disposeInitializer=this.props.onInitialized(this))})}resizeEditor(){var e;null===(e=this.codemirror)||void 0===e||e.refresh()}render(){const e=this.props.hideNavigation,t=this.settings,r=this.sandbox,o=this.currentModule;return h.createElement(y.b,null,h.createElement(y.a,{fontFamily:t.fontFamily,lineHeight:t.lineHeight,hideNavigation:e},this.state.fuzzySearchEnabled&&h.createElement(v.a,{closeFuzzySearch:this.closeFuzzySearch,setCurrentModule:this.setCurrentModule,modules:r.modules,directories:r.directories,currentModuleId:o.id}),h.createElement("div",{style:{height:"100%",fontSize:t.fontSize||14},ref:e=>{this.codemirrorElement=e}})))}}t.default=Object(p.withTheme)(x)},"./src/app/components/CodeEditor/FuzzySearch/index.js":function(e,t,r){"use strict";r.d(t,"a",(function(){return J}));var o=r("../../node_modules/@babel/runtime/helpers/extends.js"),n=r.n(o),s=r("../../node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(s),d=r("../../node_modules/lodash-es/flatten.js"),c=r("../../node_modules/lodash-es/groupBy.js"),l=r("../../node_modules/lodash-es/sortBy.js"),a=r("../../node_modules/react/index.js"),m=r("../../node_modules/downshift/dist/downshift.esm.js"),u=r("../../node_modules/match-sorter/dist/cjs/index.js"),h=r.n(u),p=r("../common/lib/sandbox/modules.js"),g=r("../common/lib/components/Input/index.js"),f=r.n(g),v=r("./src/app/pages/Sandbox/Editor/Workspace/Files/DirectoryEntry/Entry/EntryIcons/index.tsx"),y=r("./src/app/utils/get-type.ts"),b=r("../common/lib/utils/keycodes.js"),j=r("../../node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),w=r.n(j),x=r("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),C=r("../../node_modules/react-icons/lib/go/primitive-dot.js"),O=r.n(C);function E(){const e=w()(["\n  margin: 0 0.25rem;\n  font-weight: 400;\n  color: rgba(255, 255, 255, 0.5);\n"]);return E=function(){return e},e}function S(){const e=w()(["\n  margin: 0 0.5rem;\n"]);return S=function(){return e},e}function _(){const e=w()(["\n  position: absolute;\n  right: 0.75rem;\n  font-weight: 500;\n  color: ",";\n"]);return _=function(){return e},e}function z(){const e=w()(["\n  position: absolute;\n  left: 0.75rem;\n  top: 0;\n  color: ",";\n  vertical-align: middle;\n\n  margin-top: 6px;\n"]);return z=function(){return e},e}function M(){const e=w()(["\n      background-color: ",";\n    "]);return M=function(){return e},e}function k(){const e=w()(["\n      padding-left: 2rem;\n    "]);return k=function(){return e},e}function P(){const e=w()(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  font-size: 0.875rem;\n  padding: 0.25rem 0.75rem;\n  cursor: pointer;\n\n  ",";\n  color: rgba(255, 255, 255, 0.8);\n\n  ",";\n"]);return P=function(){return e},e}function I(){const e=w()(["\n  max-height: 500px;\n  overflow-y: auto;\n  overflow-x: hidden;\n"]);return I=function(){return e},e}function N(){const e=w()(["\n  padding: 0.5rem;\n  input {\n    width: 100%;\n  }\n"]);return N=function(){return e},e}function F(){const e=w()(["\n  position: absolute;\n\n  top: 0;\n  left: 0;\n  right: 0;\n\n  z-index: 60;\n\n  margin: auto;\n  padding-bottom: 0.25rem;\n\n  background-color: ",";\n\n  max-width: 650px;\n  width: 100%;\n\n  box-shadow: 0 4px 4px rgba(0, 0, 0, 0.6);\n"]);return F=function(){return e},e}const T=x.default.div.withConfig({displayName:"elements__Container",componentId:"sc-1gvuwy5-0"})(F(),e=>e.theme.background),D=x.default.div.withConfig({displayName:"elements__InputContainer",componentId:"sc-1gvuwy5-1"})(N()),L=x.default.div.withConfig({displayName:"elements__Items",componentId:"sc-1gvuwy5-2"})(I()),U=x.default.div.withConfig({displayName:"elements__Entry",componentId:"sc-1gvuwy5-3"})(P(),e=>e.isNotSynced&&Object(x.css)(k()),e=>e.isActive&&Object(x.css)(M(),e=>e.theme.secondary.clearer(.7))),W=Object(x.default)(O.a).withConfig({displayName:"elements__NotSyncedIconWithMargin",componentId:"sc-1gvuwy5-4"})(z(),e=>e.theme.templateColor||e.theme.secondary),A=x.default.div.withConfig({displayName:"elements__CurrentModuleText",componentId:"sc-1gvuwy5-5"})(_(),e=>e.theme.secondary),V=x.default.span.withConfig({displayName:"elements__Name",componentId:"sc-1gvuwy5-6"})(S()),H=x.default.span.withConfig({displayName:"elements__Path",componentId:"sc-1gvuwy5-7"})(E());function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class J extends a.PureComponent{constructor(){var e;super(...arguments),e=this,i()(this,"paths",{}),i()(this,"itemToString",e=>e?e.path:""),i()(this,"getItems",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const r=Object.keys(e.paths).map(t=>e.paths[t]);return h()(r,t,{keys:["path"]})})),i()(this,"onChange",e=>{this.props.setCurrentModule(e.m.id)}),i()(this,"handleKeyUp",e=>{e.keyCode===b.ESC&&this.props.closeFuzzySearch()})}UNSAFE_componentWillMount(){const e=this.props,t=e.modules,r=e.directories,o=t.map(e=>{const o=Object(p.getModulePath)(t,r,e.id);return{m:e,path:o,depth:o.split("/").length}}),n=Object(c.a)(o,e=>e.depth),s=Object.values(n).map(e=>Object(l.a)(e,e=>e.path)),i=Object(d.a)(s);this.paths=i.reduce((e,t)=>{let r=t.m,o=t.path;return K(K({},e),{},{[r.id]:{path:o.replace("/",""),m:r}})},{})}render(){const e=this.props.currentModuleId;return a.createElement(T,null,a.createElement(m.a,{defaultHighlightedIndex:0,defaultIsOpen:!0,onChange:this.onChange,itemToString:this.itemToString},t=>{let r=t.getInputProps,o=t.getItemProps,s=t.selectedItem,i=t.inputValue,d=t.highlightedIndex;return a.createElement("div",{style:{width:"100%"}},a.createElement(D,null,a.createElement(f.a,r({ref:e=>e&&e.focus(),onKeyUp:this.handleKeyUp,onBlur:()=>setTimeout(this.props.closeFuzzySearch,100)}))),a.createElement(L,null,this.getItems(i).map((t,r)=>a.createElement(U,n()({},o({item:t,index:r,isActive:d===r,isSelected:s===t}),{key:t.m.id,isNotSynced:t.m.isNotSynced}),t.m.isNotSynced&&a.createElement(W,null),a.createElement(v.a,{isNotSynced:t.m.isNotSynced,type:Object(y.a)(t.m.title),error:t.m.errors&&t.m.errors.length>0}),a.createElement(V,null,t.m.title),t.m.title!==this.itemToString(t)&&a.createElement(H,null,this.itemToString(t)),t.m.id===e&&a.createElement(A,null,"currently opened")))))}))}}}}]);
//# sourceMappingURL=codemirror-editor.3b47cf735.chunk.js.map